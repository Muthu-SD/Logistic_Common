
Interceptors let you:

ðŸ” Automatically attach tokens to every request (no need for auth: true everywhere)

ðŸš¨ Handle global errors (like 401, 500, etc.)

ðŸ§¹ Centralize logic so every component doesnâ€™t repeat the same checks

Api.js:-

import axios from "axios";

const API = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
});

export const apiRequest = async (method, endpoint, data = {}, options = {}) => {
  try {
    const headers = {};

    // Attach token if auth is enabled
    if (options.auth) {
      const token = localStorage.getItem("token");
      if (token) {
        headers["Authorization"] = `Bearer ${token}`;
      }
    }

    // Handle FormData or JSON
    const isFormData = options.isFormData || data instanceof FormData;
    if (!isFormData) {
      headers["Content-Type"] = "application/json";
    }

    const response = await API({
      method,
      url: endpoint,
      data,
      headers,
    });

    return response.data;
  } catch (error) {
    throw error.response?.data || { message: "Something went wrong" };
  }
};




//âœ…âœ…TOKEN using FROM ZUSTAND STORE âœ…âœ…

Api.js:-

import axios from "axios";
import useStore from "../store/UseStore";  // Import the zustand store

const API = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
});

export const apiRequest = async (method, endpoint, data = {}, options = {}) => {
  try {
    const headers = {};

    // Attach token if auth is enabled
    if (options.auth) {
      const token = useStore.getState().token; // Get token from zustand store

      if (token) {
        headers["Authorization"] = `Bearer ${token}`;
      } else {
        console.error("No token found in zustand store");
      }
    }

    // Handle FormData or JSON
    const isFormData = options.isFormData || data instanceof FormData;
    if (!isFormData) {
      headers["Content-Type"] = "application/json";
    }

    const response = await API({
      method,
      url: endpoint,
      data,
      headers,
    });

    return response.data;
  } catch (error) {
    throw error.response?.data || { message: "Something went wrong" };
  }
};

======================================================================================================================================================

//using interceptors with a custom header to conditionally skip the token.
//Why this is the best choice:
1. Centralized token handling â€” Token management is abstracted away. No need to worry about it in each component.

2. Per-request flexibility â€” You can skip the token for specific requests by simply passing { auth: false }.

3. Cleaner code â€” You donâ€™t need to handle headers or the token in every API call in your components. Just call apiRequest().

4. Global error handling â€” Automatically handles 401 errors (expired tokens) and redirects the user if necessary.

Api.js:-

import axios from "axios";

// Create axios instance
const API = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
});

// ==============================
// âœ… REQUEST INTERCEPTOR
// ==============================
API.interceptors.request.use((config) => {
  const skipAuth = config.headers["x-skip-auth"];

  if (!skipAuth) {
    const token = localStorage.getItem("token");
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
  } else {
    delete config.headers["x-skip-auth"];
  }

  return config;
});

// ==============================
// âŒ RESPONSE INTERCEPTOR (Global Error Handler)
// ==============================
API.interceptors.response.use(
  (response) => response,
  (error) => {
    const errRes = error.response;

    if (errRes) {
      if (errRes.status === 401) {
        // ðŸ” Token expired, force logout or redirect
        console.warn("Unauthorized. Logging out...");
        localStorage.removeItem("token");
        window.location.href = "/login"; // or trigger logout via context/store
      }

      // Return normalized error
      return Promise.reject(
        errRes.data?.message || errRes.data?.error || "Something went wrong"
      );
    }

    return Promise.reject("Network error");
  }
);

// ==============================
// âœ… REUSABLE REQUEST FUNCTION
// ==============================
export const apiRequest = async (
  method,
  endpoint,
  data = {},
  { customHeaders = {}, auth = true, params = {} } = {}
) => {
  try {
    const headers = { ...customHeaders };

    const isFormData = data instanceof FormData;
    if (!isFormData) {
      headers["Content-Type"] = "application/json";
    }

    // Signal interceptor to skip auth if requested
    if (!auth) {
      headers["x-skip-auth"] = true;
    }

    const response = await API({
      method,
      url: endpoint,
      data,
      params,
      headers,
    });

    return response.data;
  } catch (error) {
    throw error;
  }
};


//ALternate way âœ…âœ…TOKEN using FROM ZUSTAND STORE âœ…âœ…

Api.js:-

import axios from "axios";
import useStore from "../store/UseStore";

// Create axios instance
const API = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL,
});

// ==============================
// âœ… REQUEST INTERCEPTOR
// ==============================
API.interceptors.request.use((config) => {
  const skipAuth = config.headers["x-skip-auth"];

  if (!skipAuth) {
     // Get the token from zustand store instead of localStorage
     const token = useStore.getState().token;  // Get token from zustand store
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }
  } else {
    delete config.headers["x-skip-auth"];
  }

  return config;
});

// ==============================
// âŒ RESPONSE INTERCEPTOR (Global Error Handler)
// ==============================
API.interceptors.response.use(
  (response) => response,
  (error) => {
    const errRes = error.response;

    if (errRes) {
      if (errRes.status === 401) {
        // ðŸ” Token expired, force logout or redirect
        console.warn("Unauthorized. Logging out...");
        // Clear token from zustand store
        useStore.getState().logout();  // Calling the logout method to clear user and token
        window.location.href = "/login"; // or trigger logout via context/store
      }

      // Return normalized error
      return Promise.reject(
        errRes.data?.message || errRes.data?.error || "Something went wrong"
      );
    }

    return Promise.reject("Network error");
  }
);

// ==============================
// âœ… REUSABLE REQUEST FUNCTION
// ==============================
export const apiRequest = async (
  method,
  endpoint,
  data = {},
  { customHeaders = {}, auth = true, params = {} } = {}
) => {
  try {
    const headers = { ...customHeaders };

    const isFormData = data instanceof FormData;
    if (!isFormData) {
      headers["Content-Type"] = "application/json";
    }

    // Signal interceptor to skip auth if requested
    if (!auth) {
      headers["x-skip-auth"] = true;
    }

    const response = await API({
      method,
      url: endpoint,
      data,
      params,
      headers,
    });

    return response.data;
  } catch (error) {
    throw error;
  }
};
======================================================================================================================================================

his below is my folder structure for vite Logistics_Dashboard frontend

logistics_dashboard/
|
node_modules/
|
public/
â”‚   â””â”€â”€ android-chrome-192x192.png             
â”‚   â””â”€â”€ android-chrome-512x512.png    
â”‚   â””â”€â”€ apple-touch-icon.png             
â”‚   â””â”€â”€ favicon-16x16.png             
â”‚   â””â”€â”€ favicon-32x32.png             
â”‚   â””â”€â”€ favicon.ico            
â”‚   â””â”€â”€ logo.png                
â”‚   â””â”€â”€ site.webmanifest    
src/
â”œâ”€â”€ assets/
â”‚   â”œâ”€â”€ login / 
â”‚   â”‚   â”œâ”€â”€ Curve_Bottomleft.png
â”‚   â”‚   â”œâ”€â”€ Curve_TopRight.png
â”‚   â”‚   â”œâ”€â”€ Illustrator.svg
â”‚   â”œâ”€â”€ Logo.png 
â”‚   â”œâ”€â”€ Logo2.png 
â”‚   â”œâ”€â”€ Logo3.png 
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ Login.jsx
â”‚   â”œâ”€â”€ ForgotPassword.jsx
â”‚   â”œâ”€â”€ OtpVerification.jsx
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ chart_component/ 
â”‚   â”œâ”€â”€ country_wise_volume_chart / 
â”‚   â”‚   â”œâ”€â”€ CountryWiseVolumeChart.jsx
â”‚   â”‚   â”œâ”€â”€ fetchCountryWiseVolumeData.jsx
â”‚   â”œâ”€â”€ customs_clearance_lead_time_chart / 
â”‚   â”‚   â”œâ”€â”€ CustomsClearanceLeadTimeChart.jsx
â”‚   â”‚   â”œâ”€â”€ fetchCustomsClearanceLeadTimeData.jsx
â”‚   â”œâ”€â”€ outstanding_overdue_table / 
â”‚   â”‚   â”œâ”€â”€ OutstandingOverdueTable.jsx
â”‚   â”œâ”€â”€ shipment_in_pipeline_table / 
â”‚   â”‚   â”œâ”€â”€ ShipmentInPipelineTable.jsx
â”‚   â”œâ”€â”€ shipment_under_clearance_table / 
â”‚   â”‚   â”œâ”€â”€ ShipmentUnderClearanceTable.jsx
â”‚   â”œâ”€â”€ supplier_wise_volume_chart / 
â”‚   â”‚   â”œâ”€â”€ fetchSupplierVolumeData.jsx
â”‚   â”‚   â”œâ”€â”€ SupplierWiseVolumeChart.jsx
â”‚   â”œâ”€â”€ total_shipments_handled_chart / 
â”‚   â”‚   â”œâ”€â”€ fetchTotalShipmentsHandledData.jsx
â”‚   â”‚   â”œâ”€â”€ TotalShipmentsHandledChart.jsx
â”‚   â”œâ”€â”€ transit_lead_time_chart / 
â”‚   â”‚   â”œâ”€â”€ fetchTransitLeadTimeData.jsx
â”‚   â”‚   â”œâ”€â”€ TransitLeadTimeChart.jsx
â”‚   â”œâ”€â”€ common / 
â”‚   â”‚   â”œâ”€â”€ NoDataFallback.jsx
â”‚   â”œâ”€â”€ marquee/ 
â”‚   â”‚   â”œâ”€â”€ CurrentInfoMarquee.jsx
â”‚   â”‚   â”œâ”€â”€ fetchCurrentInfo.jsx
â”‚   â”œâ”€â”€ ImportExcel.jsx
â”‚   â”œâ”€â”€ InfoCard.jsx
â”œâ”€â”€ layouts/
â”‚   â”œâ”€â”€ Header.jsx 
â”‚   â”œâ”€â”€ MainLayout.jsx
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ dashboard/ 
â”‚   â”‚   â”œâ”€â”€ Dashboard.jsx
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ AppRoutes.jsx
â”‚   â”œâ”€â”€ ProtectedRoute.jsx
â”œâ”€â”€ store/
â”‚   â”œâ”€â”€ UseStore.js
â”œâ”€â”€ styles/
â”‚   â”œâ”€â”€ auth/ 
â”‚   â”‚   â”œâ”€â”€ AuthForm.module.css
â”‚   â”œâ”€â”€ Dashboard.module.css
â”‚   â”œâ”€â”€ Header.module.css
â”‚   â”œâ”€â”€ MainLayout.module.css
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ Api.js
â”œâ”€â”€ App.jsx
â”œâ”€â”€ index.css
â”œâ”€â”€ main.jsx
|
.env   
|                   
.env.example 
|                   
eslint.config.js   
|                   
index.html  
|                      
package-lock.json
|
package.json
|
README.md
|
vite.config.js

======================================================================================================================================================